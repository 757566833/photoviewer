{"version":3,"file":"photoviewer.common.js","sources":["../src/js/defaults.js","../src/js/utilities.js","../src/js/constants.js","../src/js/draggable.js","../src/js/movable.js","../src/js/resizable.js","../src/js/core.js"],"sourcesContent":["export default {\r\n\r\n  // Enable modal to drag\r\n  draggable: true,\r\n\r\n  // Enable modal to resize\r\n  resizable: true,\r\n\r\n  // Enable image to move\r\n  movable: true,\r\n\r\n  // Enable keyboard navigation\r\n  keyboard: true,\r\n\r\n  // Shows the title\r\n  title: true,\r\n\r\n  // Min width of modal\r\n  modalWidth: 320,\r\n\r\n  // Min height of modal\r\n  modalHeight: 320,\r\n\r\n  // Enable the page content fixed\r\n  fixedContent: true,\r\n\r\n  // Disable the modal size fixed\r\n  fixedModalSize: false,\r\n\r\n  // Disable the image viewer maximized on init\r\n  initMaximized: false,\r\n\r\n  // Threshold of modal to browser window\r\n  gapThreshold: 0.02,\r\n\r\n  // Threshold of image ratio\r\n  ratioThreshold: 0.1,\r\n\r\n  // Min ratio of image when zoom out\r\n  minRatio: 0.05,\r\n\r\n  // Max ratio of image when zoom in\r\n  maxRatio: 16,\r\n\r\n  // Toolbar options in header\r\n  headToolbar: [\r\n    'maximize',\r\n    'close'\r\n  ],\r\n\r\n  // Toolbar options in footer\r\n  footToolbar: [\r\n    'zoomIn',\r\n    'zoomOut',\r\n    'prev',\r\n    'fullscreen',\r\n    'next',\r\n    'actualSize',\r\n    'rotateRight'\r\n  ],\r\n\r\n  // Customize button icon\r\n  icons: {\r\n    minimize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n               <path fill=\"currentColor\" d=\"M20,14H4V10H20\"></path>\r\n               </svg>`,\r\n    maximize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n               <path fill=\"currentColor\" d=\"M4,4H20V20H4V4M6,8V18H18V8H6Z\"></path>\r\n               </svg>`,\r\n    close: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n            <path fill=\"currentColor\" d=\"M13.46,12L19,17.54V19H17.54L12,13.46\r\n            L6.46,19H5V17.54L10.54,12L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46\r\n            L13.46,12Z\"></path>\r\n            </svg>`,\r\n    zoomIn: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n             <path fill=\"currentColor\" d=\"M15.5,14L20.5,19L19,20.5L14,15.5V14.71\r\n             L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,\r\n             6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,\r\n             13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,\r\n             7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z\"></path>\r\n            </svg>`,\r\n    zoomOut: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n              <path fill=\"currentColor\" d=\"M15.5,14H14.71L14.43,13.73C15.41,\r\n              12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,\r\n              6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5\r\n              L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,\r\n              5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z\"></path>\r\n              </svg>`,\r\n    prev: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n           <path fill=\"currentColor\" d=\"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z\"></path>\r\n           </svg>`,\r\n    next: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n           <path fill=\"currentColor\" d=\"M16,18H18V6H16M6,18L14.5,12L6,6V18Z\"></path>\r\n           </svg>`,\r\n    fullscreen: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n                 <path fill=\"currentColor\" d=\"M8.5,12.5L11,15.5L14.5,11L19,17H5\r\n                 M23,18V6A2,2 0 0,0 21,4H3A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,\r\n                 2 0 0,0 23,18Z\"></path>\r\n                 </svg>`,\r\n    actualSize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n                 <path fill=\"currentColor\" d=\"M9.5,13.09L10.91,14.5L6.41,19H10V21\r\n                 H3V14H5V17.59L9.5,13.09M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5\r\n                 H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19H17.59L13.09,\r\n                 14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\r\n                 L13.09,9.5Z\"></path>\r\n                </svg>`,\r\n    rotateLeft: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n                 <path fill=\"currentColor\" d=\"M13,4.07V1L8.45,5.55L13,10V6.09\r\n                 C15.84,6.57 18,9.03 18,12C18,14.97 15.84,17.43 13,17.91V19.93\r\n                 C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32\r\n                 C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,\r\n                 16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89\r\n                 L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,\r\n                 8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z\"></path>\r\n                 </svg>`,\r\n    rotateRight: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n                  <path fill=\"currentColor\" d=\"M16.89,15.5L18.31,16.89C19.21,\r\n                  15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,\r\n                  15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,\r\n                  16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,\r\n                  8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,\r\n                  5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93\r\n                  V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,\r\n                  5.55Z\"></path>\r\n                  </svg>`\r\n  },\r\n\r\n  // Customize language of button title\r\n  i18n: {\r\n    minimize: 'minimize',\r\n    maximize: 'maximize',\r\n    close: 'close',\r\n    zoomIn: 'zoom-in(+)',\r\n    zoomOut: 'zoom-out(-)',\r\n    prev: 'prev(←)',\r\n    next: 'next(→)',\r\n    fullscreen: 'fullscreen',\r\n    actualSize: 'actual-size(Ctrl+Alt+0)',\r\n    rotateLeft: 'rotate-left(Ctrl+,)',\r\n    rotateRight: 'rotate-right(Ctrl+.)'\r\n  },\r\n\r\n  // Enable multiple instances\r\n  multiInstances: true,\r\n\r\n  // Enable animation\r\n  initAnimation: true,\r\n\r\n  // Disable modal position fixed when change images\r\n  fixedModalPos: false,\r\n\r\n  // Modal z-index\r\n  zIndex: 1090,\r\n\r\n  // Selector of drag handler\r\n  dragHandle: false,\r\n\r\n  // Callback events\r\n  callbacks: {\r\n    beforeOpen: $.noop,\r\n    opened: $.noop,\r\n    beforeClose: $.noop,\r\n    closed: $.noop,\r\n    beforeChange: $.noop,\r\n    changed: $.noop\r\n  },\r\n\r\n  // Start images index\r\n  index: 0,\r\n\r\n  // Load the image progressively\r\n  progressiveLoading: true\r\n\r\n}\r\n","/**\r\n * [getImgSrc]\r\n * @param {[Object]}  el    [description]\r\n */\r\nexport function getImgSrc(el) {\r\n  // Get data-src as image src at first\r\n  let src = $(el).attr('data-src')\r\n    ? $(el).attr('data-src')\r\n    : $(el).attr('href');\r\n  return src;\r\n}\r\n\r\n/**\r\n * [throttle]\r\n * @param  {Function} fn    [description]\r\n * @param  {[Number]} delay [description]\r\n * @return {Function}       [description]\r\n */\r\nexport function throttle(fn, delay) {\r\n\r\n  let timer = null;\r\n\r\n  return function () {\r\n    let context = this,\r\n      args = arguments;\r\n\r\n    clearTimeout(timer);\r\n\r\n    timer = setTimeout(function () {\r\n      fn.apply(context, args);\r\n    }, delay);\r\n  };\r\n\r\n}\r\n\r\n/**\r\n * [preloadImg]\r\n * @param  {[String]}  src      [image src]\r\n * @param  {Function}  success  [callbacks]\r\n * @param  {Function}  error    [callbacks]\r\n */\r\nexport function preloadImg(src, success, error) {\r\n\r\n  let img = new Image();\r\n\r\n  img.onload = function () {\r\n    success(img);\r\n  };\r\n\r\n  img.onerror = function () {\r\n    error(img);\r\n  };\r\n\r\n  img.src = src;\r\n\r\n}\r\n\r\n/**\r\n * [requestFullscreen]\r\n * @param  {[type]} element [description]\r\n */\r\nexport function requestFullscreen(element) {\r\n  if (element.requestFullscreen) {\r\n    element.requestFullscreen();\r\n  } else if (element.mozRequestFullScreen) {\r\n    element.mozRequestFullScreen();\r\n  } else if (element.webkitRequestFullscreen) {\r\n    element.webkitRequestFullscreen();\r\n  } else if (element.msRequestFullscreen) {\r\n    element.msRequestFullscreen();\r\n  }\r\n}\r\n\r\n/**\r\n * [exitFullscreen]\r\n */\r\nexport function exitFullscreen() {\r\n  if (document.exitFullscreen) {\r\n    document.exitFullscreen();\r\n  } else if (document.mozCancelFullScreen) {\r\n    document.mozCancelFullScreen();\r\n  } else if (document.webkitExitFullscreen) {\r\n    document.webkitExitFullscreen();\r\n  }\r\n}\r\n\r\n/**\r\n * [getImageNameFromUrl]\r\n * @param  {[String]} url [description]\r\n * @return {[String]}     [description]\r\n */\r\nexport function getImageNameFromUrl(url) {\r\n  let reg = /^.*?\\/*([^/?]*)\\.[a-z]+(\\?.+|$)/ig,\r\n    txt = url.replace(reg, '$1');\r\n  return txt;\r\n}\r\n\r\n/**\r\n * [getNumFromCSSValue]\r\n * @param  {[String]} value [description]\r\n * @return {[Number]}       [description]\r\n */\r\nexport function getNumFromCSSValue(value) {\r\n  let reg = /\\d+/g,\r\n    arr = value.match(reg),\r\n    num = parseFloat(arr[0]);\r\n  return num;\r\n}\r\n\r\n/**\r\n * [hasScrollbar]\r\n * @return {[Boolean]}       [description]\r\n */\r\nexport function hasScrollbar() {\r\n  return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);\r\n}\r\n\r\n/**\r\n * [getScrollbarWidth]\r\n * @return {[Number]}       [description]\r\n */\r\nexport function getScrollbarWidth() {\r\n\r\n  let scrollDiv = document.createElement('div');\r\n  scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';\r\n  document.body.appendChild(scrollDiv);\r\n  let scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n  document.body.removeChild(scrollDiv);\r\n\r\n  return scrollbarWidth;\r\n\r\n}\r\n\r\n/**\r\n * [setGrabCursor]\r\n * @param {[Object]}  imageData    [description]\r\n * @param {[Object]}  stageData    [description]\r\n * @param {[Object]}  stage        [description]\r\n * @param {[Boolean]} isRotate     [description]\r\n */\r\nexport function setGrabCursor(imageData, stageData, stage, isRotated) {\r\n\r\n  let imageWidth = !isRotated ? imageData.w : imageData.h,\r\n    imageHeight = !isRotated ? imageData.h : imageData.w;\r\n\r\n  if (imageHeight > stageData.h || imageWidth > stageData.w) {\r\n    stage.addClass('is-grab');\r\n  }\r\n  if (imageHeight <= stageData.h && imageWidth <= stageData.w) {\r\n    stage.removeClass('is-grab');\r\n  }\r\n}\r\n\r\n/**\r\n * [supportTouch]\r\n * @return {[Boolean]}     [description]\r\n */\r\nexport function supportTouch() {\r\n  return !!(('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch);\r\n}\r\n","import defaults from './defaults';\nimport { supportTouch } from './utilities';\n\nexport const $W = $(window);\nexport const $D = $(document);\n\nexport const CLICK_EVENT = 'click';\nexport const RESIZE_EVENT = 'resize';\nexport const KEYDOWN_EVENT = 'keydown';\nexport const WHEEL_EVENT = 'wheel mousewheel DOMMouseScroll';\n\nexport const TOUCH_START_EVENT = supportTouch() ? 'touchstart' : 'mousedown';\nexport const TOUCH_MOVE_EVENT = supportTouch() ? 'touchmove' : 'mousemove';\nexport const TOUCH_END_EVENT = supportTouch() ? 'touchend' : 'mouseup';\n\nexport const NS = 'photoviewer';\nexport const CLASS_NS = '.' + NS;\nexport const EVENT_NS = '.' + NS;\n\nexport const PUBLIC_VARS = {\n  // image moving flag\n  isMoving: false,\n  // modal resizing flag\n  isResizing: false,\n  // modal z-index setting\n  zIndex: defaults.zIndex,\n};\n","import {\r\n  $D,\r\n  TOUCH_START_EVENT,\r\n  TOUCH_MOVE_EVENT,\r\n  TOUCH_END_EVENT,\r\n  EVENT_NS,\r\n  PUBLIC_VARS\r\n} from './constants';\r\n\r\nexport default {\r\n\r\n  /**\r\n   * [draggable]\r\n   * @param  {[Object]} modal       [the modal element]\r\n   * @param  {[Object]} dragHandle  [the handle element when dragging]\r\n   * @param  {[Object]} dragCancel  [the cancel element when dragging]\r\n   */\r\n  draggable(modal, dragHandle, dragCancel) {\r\n\r\n    let isDragging = false;\r\n\r\n    let startX = 0,\r\n      startY = 0,\r\n\r\n      left = 0,\r\n      top = 0;\r\n\r\n    let dragStart = (e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      // Must be removed\r\n      // e.preventDefault();\r\n\r\n      if (this.options.multiInstances) {\r\n        modal.css('z-index', ++PUBLIC_VARS['zIndex']);\r\n      }\r\n\r\n      // Get clicked button\r\n      let elemCancel = $(e.target).closest(dragCancel);\r\n      // Stop modal moving when click buttons\r\n      if (elemCancel.length) {\r\n        return true;\r\n      }\r\n\r\n      isDragging = true;\r\n\r\n      startX = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageX\r\n        : e.clientX;\r\n      startY = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageY\r\n        : e.clientY;\r\n\r\n      left = $(modal).offset().left;\r\n      top = $(modal).offset().top;\r\n\r\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n    };\r\n\r\n    let dragMove = (e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      e.preventDefault();\r\n\r\n      if (isDragging && !PUBLIC_VARS['isMoving'] && !PUBLIC_VARS['isResizing'] && !this.isMaximized) {\r\n\r\n        let endX = e.type === 'touchmove'\r\n          ? e.originalEvent.targetTouches[0].pageX\r\n          : e.clientX,\r\n          endY = e.type === 'touchmove'\r\n            ? e.originalEvent.targetTouches[0].pageY\r\n            : e.clientY,\r\n\r\n          relativeX = endX - startX,\r\n          relativeY = endY - startY;\r\n\r\n        $(modal).css({\r\n          left: relativeX + left + 'px',\r\n          top: relativeY + top + 'px'\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n    let dragEnd = () => {\r\n\r\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n      isDragging = false;\r\n\r\n    };\r\n\r\n    $(dragHandle).on(TOUCH_START_EVENT + EVENT_NS, dragStart);\r\n\r\n  }\r\n\r\n}\r\n","import {\r\n  $D,\r\n  TOUCH_START_EVENT,\r\n  TOUCH_MOVE_EVENT,\r\n  TOUCH_END_EVENT,\r\n  NS,\r\n  EVENT_NS,\r\n  PUBLIC_VARS\r\n} from './constants';\r\n\r\nconst ELEMS_WITH_GRABBING_CURSOR = `html,body,.${NS}-modal,.${NS}-stage,.${NS}-button,.${NS}-resizable-handle`;\r\n\r\nexport default {\r\n\r\n  /**\r\n   * --------------------------------------\r\n   * 1.no movable\r\n   * 2.vertical movable\r\n   * 3.horizontal movable\r\n   * 4.vertical & horizontal movable\r\n   * --------------------------------------\r\n   *\r\n   * [image movable]\r\n   * @param  {[Object]} stage   [the stage element]\r\n   * @param  {[Object]} image   [the image element]\r\n   */\r\n  movable(stage, image) {\r\n\r\n    let isDragging = false;\r\n\r\n    let startX = 0,\r\n      startY = 0,\r\n\r\n      left = 0,\r\n      top = 0,\r\n\r\n      widthDiff = 0,\r\n      heightDiff = 0,\r\n\r\n      δ = 0;\r\n\r\n    let dragStart = (e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      e.preventDefault();\r\n\r\n      let imageWidth = $(image).width(),\r\n        imageHeight = $(image).height(),\r\n        stageWidth = $(stage).width(),\r\n        stageHeight = $(stage).height();\r\n\r\n      startX = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageX\r\n        : e.clientX;\r\n      startY = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageY\r\n        : e.clientY;\r\n\r\n      // δ is the difference between image width and height\r\n      δ = !this.isRotated ? 0 : (imageWidth - imageHeight) / 2;\r\n\r\n      // Width or height difference can be use to limit image right or top position\r\n      widthDiff = !this.isRotated\r\n        ? (imageWidth - stageWidth)\r\n        : (imageHeight - stageWidth);\r\n      heightDiff = !this.isRotated\r\n        ? (imageHeight - stageHeight)\r\n        : (imageWidth - stageHeight);\r\n\r\n      // Modal can be dragging if image is smaller to stage\r\n      isDragging = (widthDiff > 0 || heightDiff > 0) ? true : false;\r\n      PUBLIC_VARS['isMoving'] = (widthDiff > 0 || heightDiff > 0) ? true : false;\r\n\r\n      // Reclac the element position when mousedown\r\n      // Fixed the issue of stage with a border\r\n      left = $(image).position().left - δ;\r\n      top = $(image).position().top + δ;\r\n\r\n      // Add grabbing cursor\r\n      if (stage.hasClass('is-grab')) {\r\n        $(ELEMS_WITH_GRABBING_CURSOR).addClass('is-grabbing');\r\n      }\r\n\r\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n    };\r\n\r\n    let dragMove = (e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      e.preventDefault();\r\n\r\n      if (isDragging) {\r\n\r\n        let endX = e.type === 'touchmove'\r\n          ? e.originalEvent.targetTouches[0].pageX\r\n          : e.clientX,\r\n          endY = e.type === 'touchmove'\r\n            ? e.originalEvent.targetTouches[0].pageY\r\n            : e.clientY,\r\n\r\n          relativeX = endX - startX,\r\n          relativeY = endY - startY,\r\n\r\n          newLeft = relativeX + left,\r\n          newTop = relativeY + top;\r\n\r\n        // vertical limit\r\n        if (heightDiff > 0) {\r\n\r\n          if ((relativeY + top) > δ) {\r\n            newTop = δ;\r\n          } else if ((relativeY + top) < -heightDiff + δ) {\r\n            newTop = -heightDiff + δ;\r\n          }\r\n\r\n        } else {\r\n          newTop = top;\r\n        }\r\n        // horizontal limit\r\n        if (widthDiff > 0) {\r\n\r\n          if ((relativeX + left) > -δ) {\r\n            newLeft = -δ;\r\n          } else if ((relativeX + left) < -widthDiff - δ) {\r\n            newLeft = -widthDiff - δ;\r\n          }\r\n\r\n        } else {\r\n          newLeft = left;\r\n        }\r\n\r\n        $(image).css({\r\n          left: newLeft + 'px',\r\n          top: newTop + 'px'\r\n        });\r\n\r\n        // Update image initial data\r\n        $.extend(this.imageData, {\r\n          left: newLeft,\r\n          top: newTop\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n    let dragEnd = () => {\r\n\r\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n      isDragging = false;\r\n      PUBLIC_VARS['isMoving'] = false;\r\n\r\n      // Remove grabbing cursor\r\n      $(ELEMS_WITH_GRABBING_CURSOR).removeClass('is-grabbing');\r\n\r\n    };\r\n\r\n    $(stage).on(TOUCH_START_EVENT + EVENT_NS, dragStart);\r\n\r\n  }\r\n\r\n}\r\n","import {\r\n  $D,\r\n  TOUCH_START_EVENT,\r\n  TOUCH_MOVE_EVENT,\r\n  TOUCH_END_EVENT,\r\n  NS,\r\n  EVENT_NS,\r\n  PUBLIC_VARS\r\n} from './constants';\r\n\r\nimport {\r\n  setGrabCursor\r\n} from './utilities';\r\n\r\nconst ELEMS_WITH_RESIZE_CURSOR = `html,body,.${NS}-modal,.${NS}-stage,.${NS}-button`;\r\n\r\nexport default {\r\n\r\n  /**\r\n   * ------------------------------\r\n   * 1.modal resizable\r\n   * 2.keep image in stage center\r\n   * 3.other image limitations\r\n   * ------------------------------\r\n   *\r\n   * [resizable]\r\n   * @param  {[Object]} modal       [the modal element]\r\n   * @param  {[Object]} stage       [the stage element]\r\n   * @param  {[Object]} image       [the image element]\r\n   * @param  {[Number]} minWidth    [the option of modalWidth]\r\n   * @param  {[Number]} minHeight   [the option of modalHeight]\r\n   */\r\n  resizable(modal, stage, image, minWidth, minHeight) {\r\n\r\n    let resizableHandleE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-e\"></div>`),\r\n      resizableHandleW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-w\"></div>`),\r\n      resizableHandleS = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-s\"></div>`),\r\n      resizableHandleN = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-n\"></div>`),\r\n      resizableHandleSE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-se\"></div>`),\r\n      resizableHandleSW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-sw\"></div>`),\r\n      resizableHandleNE = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-ne\"></div>`),\r\n      resizableHandleNW = $(`<div class=\"${NS}-resizable-handle ${NS}-resizable-handle-nw\"></div>`);\r\n\r\n    let resizableHandles = {\r\n      'e': resizableHandleE,\r\n      's': resizableHandleS,\r\n      'se': resizableHandleSE,\r\n      'n': resizableHandleN,\r\n      'w': resizableHandleW,\r\n      'nw': resizableHandleNW,\r\n      'ne': resizableHandleNE,\r\n      'sw': resizableHandleSW\r\n    };\r\n\r\n    $(modal).append(\r\n      resizableHandleE, resizableHandleW, resizableHandleS, resizableHandleN,\r\n      resizableHandleSE, resizableHandleSW, resizableHandleNE, resizableHandleNW\r\n    );\r\n\r\n    let isDragging = false;\r\n\r\n    let startX = 0,\r\n      startY = 0,\r\n\r\n      modalData = {\r\n        w: 0,\r\n        h: 0,\r\n        l: 0,\r\n        t: 0\r\n      },\r\n      stageData = {\r\n        w: 0,\r\n        h: 0,\r\n        l: 0,\r\n        t: 0\r\n      },\r\n      imageData = {\r\n        w: 0,\r\n        h: 0,\r\n        l: 0,\r\n        t: 0\r\n      },\r\n\r\n      // δ is the difference between image width and height\r\n      δ = 0,\r\n      imgWidth = 0,\r\n      imgHeight = 0,\r\n\r\n      direction = '';\r\n\r\n    // modal CSS options\r\n    let getModalOpts = function (dir, offsetX, offsetY) {\r\n\r\n      // Modal should not move when its width to the minwidth\r\n      let modalLeft = (-offsetX + modalData.w) > minWidth\r\n        ? (offsetX + modalData.l)\r\n        : (modalData.l + modalData.w - minWidth),\r\n        modalTop = (-offsetY + modalData.h) > minHeight\r\n          ? (offsetY + modalData.t)\r\n          : (modalData.t + modalData.h - minHeight);\r\n\r\n      let opts = {\r\n        'e': {\r\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px'\r\n        },\r\n        's': {\r\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px'\r\n        },\r\n        'se': {\r\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px',\r\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px'\r\n        },\r\n        'w': {\r\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\r\n          left: modalLeft + 'px'\r\n        },\r\n        'n': {\r\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\r\n          top: modalTop + 'px'\r\n        },\r\n        'nw': {\r\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\r\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\r\n          top: modalTop + 'px',\r\n          left: modalLeft + 'px'\r\n        },\r\n        'ne': {\r\n          width: Math.max((offsetX + modalData.w), minWidth) + 'px',\r\n          height: Math.max((-offsetY + modalData.h), minHeight) + 'px',\r\n          top: modalTop + 'px'\r\n        },\r\n        'sw': {\r\n          width: Math.max((-offsetX + modalData.w), minWidth) + 'px',\r\n          height: Math.max((offsetY + modalData.h), minHeight) + 'px',\r\n          left: modalLeft + 'px'\r\n        }\r\n      };\r\n\r\n      return opts[dir];\r\n    };\r\n\r\n    // image CSS options\r\n    let getImageOpts = function (dir, offsetX, offsetY) {\r\n\r\n      // Image should not move when modal width to the min width\r\n      // The minwidth is modal width, so we should clac the stage minwidth\r\n      let widthDiff = (offsetX + modalData.w) > minWidth\r\n        ? (stageData.w - imgWidth + offsetX - δ)\r\n        : (minWidth - (modalData.w - stageData.w) - imgWidth - δ),\r\n        heightDiff = (offsetY + modalData.h) > minHeight\r\n          ? (stageData.h - imgHeight + offsetY + δ)\r\n          : (minHeight - (modalData.h - stageData.h) - imgHeight + δ),\r\n\r\n        widthDiff2 = (-offsetX + modalData.w) > minWidth\r\n          ? (stageData.w - imgWidth - offsetX - δ)\r\n          : (minWidth - (modalData.w - stageData.w) - imgWidth - δ),\r\n        heightDiff2 = (-offsetY + modalData.h) > minHeight\r\n          ? (stageData.h - imgHeight - offsetY + δ)\r\n          : (minHeight - (modalData.h - stageData.h) - imgHeight + δ);\r\n\r\n      // Get image position in dragging\r\n      let imgLeft = (widthDiff > 0\r\n        ? $(image).position().left\r\n        : ($(image).position().left < 0\r\n          ? $(image).position().left\r\n          : 0)) - δ,\r\n        imgTop = (heightDiff > 0\r\n          ? $(image).position().top\r\n          : ($(image).position().top < 0\r\n            ? $(image).position().top\r\n            : 0)) + δ,\r\n\r\n        imgLeft2 = (widthDiff2 > 0\r\n          ? $(image).position().left\r\n          : ($(image).position().left < 0\r\n            ? $(image).position().left\r\n            : 0)) - δ,\r\n        imgTop2 = (heightDiff2 > 0\r\n          ? $(image).position().top\r\n          : ($(image).position().top < 0\r\n            ? $(image).position().top\r\n            : 0)) + δ;\r\n\r\n      let opts = {\r\n        'e': {\r\n          left: widthDiff >= -δ\r\n            ? ((widthDiff - δ) / 2 + 'px')\r\n            : (imgLeft > widthDiff\r\n              ? (imgLeft + 'px')\r\n              : (widthDiff + 'px'))\r\n        },\r\n        's': {\r\n          top: heightDiff >= δ\r\n            ? ((heightDiff + δ) / 2 + 'px')\r\n            : (imgTop > heightDiff\r\n              ? (imgTop + 'px')\r\n              : (heightDiff + 'px'))\r\n        },\r\n        'se': {\r\n          top: heightDiff >= δ\r\n            ? ((heightDiff + δ) / 2 + 'px')\r\n            : (imgTop > heightDiff\r\n              ? (imgTop + 'px')\r\n              : (heightDiff + 'px')),\r\n          left: widthDiff >= -δ\r\n            ? ((widthDiff - δ) / 2 + 'px')\r\n            : (imgLeft > widthDiff\r\n              ? (imgLeft + 'px')\r\n              : (widthDiff + 'px'))\r\n        },\r\n        'w': {\r\n          left: widthDiff2 >= -δ\r\n            ? ((widthDiff2 - δ) / 2 + 'px')\r\n            : (imgLeft2 > widthDiff2\r\n              ? (imgLeft2 + 'px')\r\n              : (widthDiff2 + 'px'))\r\n        },\r\n        'n': {\r\n          top: heightDiff2 >= δ\r\n            ? ((heightDiff2 + δ) / 2 + 'px')\r\n            : (imgTop2 > heightDiff2\r\n              ? (imgTop2 + 'px')\r\n              : (heightDiff2 + 'px'))\r\n        },\r\n        'nw': {\r\n          top: heightDiff2 >= δ\r\n            ? ((heightDiff2 + δ) / 2 + 'px')\r\n            : (imgTop2 > heightDiff2\r\n              ? (imgTop2 + 'px')\r\n              : (heightDiff2 + 'px')),\r\n          left: widthDiff2 >= -δ\r\n            ? ((widthDiff2 - δ) / 2 + 'px')\r\n            : (imgLeft2 > widthDiff2\r\n              ? (imgLeft2 + 'px')\r\n              : (widthDiff2 + 'px'))\r\n        },\r\n        'ne': {\r\n          top: heightDiff2 >= δ\r\n            ? ((heightDiff2 + δ) / 2 + 'px')\r\n            : (imgTop2 > heightDiff2\r\n              ? (imgTop2 + 'px')\r\n              : (heightDiff2 + 'px')),\r\n          left: widthDiff >= -δ\r\n            ? ((widthDiff - δ) / 2 + 'px')\r\n            : (imgLeft > widthDiff\r\n              ? (imgLeft + 'px')\r\n              : (widthDiff + 'px'))\r\n        },\r\n        'sw': {\r\n          top: heightDiff >= δ\r\n            ? ((heightDiff + δ) / 2 + 'px')\r\n            : (imgTop > heightDiff\r\n              ? (imgTop + 'px')\r\n              : (heightDiff + 'px')),\r\n          left: widthDiff2 >= -δ\r\n            ? ((widthDiff2 - δ) / 2 + 'px')\r\n            : (imgLeft2 > widthDiff2\r\n              ? (imgLeft2 + 'px')\r\n              : (widthDiff2 + 'px'))\r\n        }\r\n      };\r\n\r\n      return opts[dir];\r\n    };\r\n\r\n    let dragStart = (dir, e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      e.preventDefault();\r\n\r\n      isDragging = true;\r\n      PUBLIC_VARS['isResizing'] = true;\r\n\r\n      startX = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageX\r\n        : e.clientX;\r\n      startY = e.type === 'touchstart'\r\n        ? e.originalEvent.targetTouches[0].pageY\r\n        : e.clientY;\r\n\r\n      // Reclac the modal data when mousedown\r\n      modalData = {\r\n        w: $(modal).width(),\r\n        h: $(modal).height(),\r\n        l: $(modal).offset().left,\r\n        t: $(modal).offset().top\r\n      };\r\n\r\n      stageData = {\r\n        w: $(stage).width(),\r\n        h: $(stage).height(),\r\n        l: $(stage).offset().left,\r\n        t: $(stage).offset().top\r\n      };\r\n\r\n      imageData = {\r\n        w: $(image).width(),\r\n        h: $(image).height(),\r\n        l: $(image).position().left,\r\n        t: $(image).position().top\r\n      };\r\n\r\n      // δ is the difference between image width and height\r\n      δ = !this.isRotated\r\n        ? 0\r\n        : (imageData.w - imageData.h) / 2;\r\n      imgWidth = !this.isRotated\r\n        ? imageData.w\r\n        : imageData.h;\r\n      imgHeight = !this.isRotated\r\n        ? imageData.h\r\n        : imageData.w;\r\n\r\n      direction = dir;\r\n\r\n      // Add resizable cursor\r\n      $(ELEMS_WITH_RESIZE_CURSOR).css('cursor', dir + '-resize');\r\n\r\n      $D.on(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .on(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n    };\r\n\r\n    let dragMove = (e) => {\r\n\r\n      e = e || window.event;\r\n\r\n      e.preventDefault();\r\n\r\n      if (isDragging && !this.isMaximized) {\r\n\r\n        let endX = e.type === 'touchmove'\r\n          ? e.originalEvent.targetTouches[0].pageX\r\n          : e.clientX,\r\n          endY = e.type === 'touchmove'\r\n            ? e.originalEvent.targetTouches[0].pageY\r\n            : e.clientY,\r\n\r\n          relativeX = endX - startX,\r\n          relativeY = endY - startY;\r\n\r\n        let modalOpts = getModalOpts(direction, relativeX, relativeY);\r\n\r\n        $(modal).css(modalOpts);\r\n\r\n        let imageOpts = getImageOpts(direction, relativeX, relativeY);\r\n\r\n        $(image).css(imageOpts);\r\n\r\n        this.isDoResize = true;\r\n\r\n      }\r\n\r\n    };\r\n\r\n    let dragEnd = () => {\r\n\r\n      $D.off(TOUCH_MOVE_EVENT + EVENT_NS, dragMove)\r\n        .off(TOUCH_END_EVENT + EVENT_NS, dragEnd);\r\n\r\n      // Set grab cursor\r\n      if (PUBLIC_VARS['isResizing']) {\r\n        setGrabCursor(\r\n          {\r\n            w: imgWidth,\r\n            h: imgHeight\r\n          },\r\n          {\r\n            w: $(stage).width(),\r\n            h: $(stage).height()\r\n          },\r\n          stage\r\n        );\r\n      }\r\n\r\n      isDragging = false;\r\n      PUBLIC_VARS['isResizing'] = false;\r\n\r\n      // Remove resizable cursor\r\n      $(ELEMS_WITH_RESIZE_CURSOR).css('cursor', '');\r\n\r\n      // Update image initial data\r\n      let scale = this.getImageScaleToStage(\r\n        $(stage).width(),\r\n        $(stage).height()\r\n      );\r\n\r\n      $.extend(this.imageData, {\r\n        initWidth: this.img.width * scale,\r\n        initHeight: this.img.height * scale,\r\n        initLeft: ($(stage).width() - this.img.width * scale) / 2,\r\n        initTop: ($(stage).height() - this.img.height * scale) / 2\r\n      });\r\n\r\n    };\r\n\r\n    $.each(resizableHandles, function (dir, handle) {\r\n      handle.on(TOUCH_START_EVENT + EVENT_NS, function (e) {\r\n        dragStart(dir, e);\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import $ from 'jquery';\n\nimport DEFAULTS from './defaults';\n\nimport {\n  $W,\n  $D,\n  CLICK_EVENT,\n  RESIZE_EVENT,\n  KEYDOWN_EVENT,\n  WHEEL_EVENT,\n  NS,\n  CLASS_NS,\n  EVENT_NS,\n  PUBLIC_VARS\n} from './constants';\n\nimport {\n  getImgSrc,\n  throttle,\n  preloadImg,\n  requestFullscreen,\n  getImageNameFromUrl,\n  getNumFromCSSValue,\n  hasScrollbar,\n  getScrollbarWidth,\n  setGrabCursor\n} from './utilities';\n\nimport draggable from './draggable';\nimport movable from './movable';\nimport resizable from './resizable';\n\n/**\n * PhotoViewer Class\n */\nclass PhotoViewer {\n\n  constructor(items, options, el) {\n\n    this.options = $.extend(true, {}, DEFAULTS, options);\n\n    if (options && $.isArray(options.footToolbar)) {\n      this.options.footToolbar = options.footToolbar;\n    }\n\n    if (options && $.isArray(options.headToolbar)) {\n      this.options.headToolbar = options.headToolbar;\n    }\n\n    // Store element of clicked\n    this.$el = $(el);\n\n    // As we have multiple instances,\n    // so every instance has following variables.\n\n    // modal open flag\n    this.isOpened = false;\n    // modal maximize flag\n    this.isMaximized = false;\n    // image rotate 90*(2n+1) flag\n    this.isRotated = false;\n    // image rotate angle\n    this.rotateAngle = 0;\n\n    // if modal do resize\n    this.isDoResize = false;\n\n    // Store image data in every instance\n    this.imageData = {};\n    // Store modal data in every instance\n    this.modalData = {\n      width: null,\n      height: null,\n      left: null,\n      top: null\n    };\n\n    this.init(items, this.options, el);\n\n  }\n\n  init(items, opts, el) {\n\n    this.groupData = items;\n    this.groupIndex = opts['index'];\n\n    // Get image src\n    let imgSrc = items[this.groupIndex]['src'];\n\n    this.open();\n\n    this.loadImg(imgSrc);\n\n    // draggable & movable & resizable\n    if (opts.draggable) {\n      this.draggable(this.$photoviewer, this.dragHandle, CLASS_NS + '-button');\n    }\n    if (opts.movable) {\n      this.movable(this.$stage, this.$image);\n    }\n    if (opts.resizable) {\n      this.resizable(\n        this.$photoviewer,\n        this.$stage,\n        this.$image,\n        opts.modalWidth,\n        opts.modalHeight\n      );\n    }\n\n  }\n\n  _creatBtns(toolbar, btns) {\n\n    let btnsStr = '';\n\n    $.each(toolbar, function (index, item) {\n      btnsStr += btns[item];\n    });\n\n    return btnsStr;\n\n  }\n\n  _creatTitle() {\n    return (this.options.title ? `<div class=\"${NS}-title\"></div>` : '');\n  }\n\n  _creatDOM() {\n\n    let btnsTpl = {\n      minimize: `<button class=\"${NS}-button ${NS}-button-minimize\"\n                  title=\"${this.options.i18n.minimize}\">\n                    ${this.options.icons.minimize}\n                  </button>`,\n      maximize: `<button class=\"${NS}-button ${NS}-button-maximize\"\n                  title=\"${this.options.i18n.maximize}\">\n                    ${this.options.icons.maximize}\n                  </button>`,\n      close: `<button class=\"${NS}-button ${NS}-button-close\"\n              title=\"${this.options.i18n.close}\">\n                ${this.options.icons.close}\n              </button>`,\n      zoomIn: `<button class=\"${NS}-button ${NS}-button-zoom-in\"\n                title=\"${this.options.i18n.zoomIn}\">\n                  ${this.options.icons.zoomIn}\n                </button>`,\n      zoomOut: `<button class=\"${NS}-button ${NS}-button-zoom-out\"\n                title=\"${this.options.i18n.zoomOut}\">\n                  ${this.options.icons.zoomOut}\n                </button>`,\n      prev: `<button class=\"${NS}-button ${NS}-button-prev\"\n              title=\"${this.options.i18n.prev}\">\n                ${this.options.icons.prev}\n              </button>`,\n      next: `<button class=\"${NS}-button ${NS}-button-next\"\n              title=\"${this.options.i18n.next}\">\n                ${this.options.icons.next}\n              </button>`,\n      fullscreen: `<button class=\"${NS}-button ${NS}-button-fullscreen\"\n                    title=\"${this.options.i18n.fullscreen}\">\n                    ${this.options.icons.fullscreen}\n                  </button>`,\n      actualSize: `<button class=\"${NS}-button ${NS}-button-actual-size\"\n                    title=\"${this.options.i18n.actualSize}\">\n                      ${this.options.icons.actualSize}\n                    </button>`,\n      rotateLeft: `<button class=\"${NS}-button ${NS}-button-rotate-left\"\n                    title=\"${this.options.i18n.rotateLeft}\">\n                      ${this.options.icons.rotateLeft}\n                    </button>`,\n      rotateRight: `<button class=\"${NS}-button ${NS}-button-rotate-right\"\n                      title=\"${this.options.i18n.rotateRight}\">\n                      ${this.options.icons.rotateRight}\n                    </button>`\n    };\n\n    // photoviewer base HTML\n    let photoviewerHTML =\n      `<div class=\"${NS}-modal\">\n        <div class=\"${NS}-inner\">\n          <div class=\"${NS}-header\">\n            <div class=\"${NS}-toolbar ${NS}-toolbar-head\">\n              ${this._creatBtns(this.options.headToolbar, btnsTpl)}\n            </div>\n            ${this._creatTitle()}\n          </div>\n          <div class=\"${NS}-stage\">\n            <img class=\"${NS}-image\" src=\"\" alt=\"\" />\n          </div>\n          <div class=\"${NS}-footer\">\n            <div class=\"${NS}-toolbar ${NS}-toolbar-foot\">\n              ${this._creatBtns(this.options.footToolbar, btnsTpl)}\n            </div>\n          </div>\n        </div>\n      </div>`;\n\n    return photoviewerHTML;\n\n  }\n\n  build() {\n\n    // Create photoviewer HTML string\n    let photoviewerHTML = this._creatDOM();\n\n    // Make photoviewer HTML string to jQuery element\n    let $photoviewer = $(photoviewerHTML);\n\n    // Get all photoviewer element\n    this.$photoviewer = $photoviewer;\n    this.$header = $photoviewer.find(CLASS_NS + '-header');\n    this.$headToolbar = $photoviewer.find(CLASS_NS + '-toolbar-head');\n    this.$footer = $photoviewer.find(CLASS_NS + '-footer');\n    this.$footToolbar = $photoviewer.find(CLASS_NS + '-toolbar-foot');\n    this.$stage = $photoviewer.find(CLASS_NS + '-stage');\n    this.$title = $photoviewer.find(CLASS_NS + '-title');\n    this.$image = $photoviewer.find(CLASS_NS + '-image');\n    this.$close = $photoviewer.find(CLASS_NS + '-button-close');\n    this.$maximize = $photoviewer.find(CLASS_NS + '-button-maximize');\n    this.$minimize = $photoviewer.find(CLASS_NS + '-button-minimize');\n    this.$zoomIn = $photoviewer.find(CLASS_NS + '-button-zoom-in');\n    this.$zoomOut = $photoviewer.find(CLASS_NS + '-button-zoom-out');\n    this.$actualSize = $photoviewer.find(CLASS_NS + '-button-actual-size');\n    this.$fullscreen = $photoviewer.find(CLASS_NS + '-button-fullscreen');\n    this.$rotateLeft = $photoviewer.find(CLASS_NS + '-button-rotate-left');\n    this.$rotateRight = $photoviewer.find(CLASS_NS + '-button-rotate-right');\n    this.$prev = $photoviewer.find(CLASS_NS + '-button-prev');\n    this.$next = $photoviewer.find(CLASS_NS + '-button-next');\n\n    // Add class before image loaded\n    this.$stage.addClass('stage-ready');\n    this.$image.addClass('image-ready');\n\n    // Reset modal z-index with multiple instances\n    this.$photoviewer.css('z-index', PUBLIC_VARS['zIndex']);\n\n    // Set handle element of draggable\n    if (!this.options.dragHandle || this.options.dragHandle === CLASS_NS + '-modal') {\n      this.dragHandle = this.$photoviewer;\n    } else {\n      this.dragHandle = this.$photoviewer.find(this.options.dragHandle);\n    }\n\n  }\n\n  open() {\n\n    if (!this.options.multiInstances) {\n      $(CLASS_NS + '-modal').eq(0).remove();\n    }\n\n    // Fixed modal position bug\n    if (!$(CLASS_NS + '-modal').length && this.options.fixedContent) {\n\n      $('html').css({ 'overflow': 'hidden' });\n\n      if (hasScrollbar()) {\n        let scrollbarWidth = getScrollbarWidth();\n        if (scrollbarWidth) {\n          $('html').css({ 'padding-right': scrollbarWidth });\n        }\n      }\n\n    }\n\n    this.build();\n\n    this._triggerHook('beforeOpen', this.$el);\n\n    // Add PhotoViewer to DOM\n    $('body').append(this.$photoviewer);\n\n    this.addEvents();\n\n    this.setModalPos(this.$photoviewer);\n\n    this._triggerHook('opened', this.$el);\n\n  }\n\n  close() {\n\n    this._triggerHook('beforeClose', this.$el);\n\n    // Remove instance\n    this.$photoviewer.remove();\n\n    this.isOpened = false;\n    this.isMaximized = false;\n    this.isRotated = false;\n    this.rotateAngle = 0;\n\n    let zeroModal = !$(CLASS_NS + '-modal').length;\n\n    // Fixed modal position bug\n    if (zeroModal && this.options.fixedContent) {\n      $('html').css({ 'overflow': '', 'padding-right': '' });\n    }\n\n    // Reset zIndex after close\n    if (zeroModal && this.options.multiInstances) {\n      PUBLIC_VARS['zIndex'] = this.options.zIndex;\n    }\n\n    // off events\n    if (!$(CLASS_NS + '-modal').length) {\n      $D.off(KEYDOWN_EVENT + EVENT_NS);\n      $W.off(RESIZE_EVENT + EVENT_NS);\n    }\n\n    this._triggerHook('closed', this.$el);\n\n  }\n\n  setModalPos(modal) {\n\n    let winWidth = $W.width(),\n      winHeight = $W.height(),\n      scrollLeft = $D.scrollLeft(),\n      scrollTop = $D.scrollTop();\n\n    let modalWidth = this.options.modalWidth,\n      modalHeight = this.options.modalHeight;\n\n    // Set modal maximized when init\n    if (this.options.initMaximized) {\n\n      modal.addClass(NS + '-maximize');\n\n      modal.css({\n        width: '100%',\n        height: '100%',\n        left: 0,\n        top: 0\n      });\n\n      this.isOpened = true;\n      this.isMaximized = true;\n\n    } else {\n\n      // Make the modal in windows center\n      modal.css({\n        width: modalWidth,\n        height: modalHeight,\n        left: (winWidth - modalWidth) / 2 + scrollLeft + 'px',\n        top: (winHeight - modalHeight) / 2 + scrollTop + 'px'\n      });\n\n    }\n\n  }\n\n  setModalSize(img) {\n\n    let winWidth = $W.width(),\n      winHeight = $W.height(),\n      scrollLeft = $D.scrollLeft(),\n      scrollTop = $D.scrollTop();\n\n    // stage css value\n    let stageCSS = {\n      left: this.$stage.css('left'),\n      right: this.$stage.css('right'),\n      top: this.$stage.css('top'),\n      bottom: this.$stage.css('bottom'),\n      borderLeft: this.$stage.css('border-left-width'),\n      borderRight: this.$stage.css('border-right-width'),\n      borderTop: this.$stage.css('border-top-width'),\n      borderBottom: this.$stage.css('border-bottom-width')\n    };\n\n    // Modal size should calc with stage css value\n    let modalWidth = img.width +\n      getNumFromCSSValue(stageCSS.left) +\n      getNumFromCSSValue(stageCSS.right) +\n      getNumFromCSSValue(stageCSS.borderLeft) +\n      getNumFromCSSValue(stageCSS.borderRight),\n      modalHeight = img.height +\n        getNumFromCSSValue(stageCSS.top) +\n        getNumFromCSSValue(stageCSS.bottom) +\n        getNumFromCSSValue(stageCSS.borderTop) +\n        getNumFromCSSValue(stageCSS.borderBottom);\n\n    let gapThreshold = (this.options.gapThreshold > 0 ? this.options.gapThreshold : 0) + 1,\n      // modal scale to window\n      scale = Math.min(\n        winWidth / (modalWidth * gapThreshold),\n        winHeight / (modalHeight * gapThreshold),\n        1\n      );\n\n    let minWidth = Math.max(modalWidth * scale, this.options.modalWidth),\n      minHeight = Math.max(modalHeight * scale, this.options.modalHeight);\n\n    minWidth = this.options.fixedModalSize\n      ? this.options.modalWidth\n      : Math.round(minWidth);\n    minHeight = this.options.fixedModalSize\n      ? this.options.modalHeight\n      : Math.round(minHeight);\n\n    let modalCSSObj = {\n      width: minWidth + 'px',\n      height: minHeight + 'px',\n      left: (winWidth - minWidth) / 2 + scrollLeft + 'px',\n      top: (winHeight - minHeight) / 2 + scrollTop + 'px'\n    };\n\n    // Add modal init animation\n    if (this.options.initAnimation) {\n      this.$photoviewer.animate(modalCSSObj, () => {\n        this.setImageSize(img);\n      });\n    } else {\n      this.$photoviewer.css(modalCSSObj);\n      this.setImageSize(img);\n    }\n\n    this.isOpened = true;\n\n  }\n\n  getImageScaleToStage(stageWidth, stageHeight) {\n\n    var scale = 1;\n\n    if (!this.isRotated) {\n      scale = Math.min(stageWidth / this.img.width, stageHeight / this.img.height, 1);\n    } else {\n      scale = Math.min(stageWidth / this.img.height, stageHeight / this.img.width, 1);\n    }\n\n    return scale;\n  }\n\n  setImageSize(img) {\n\n    let stageData = {\n      w: this.$stage.width(),\n      h: this.$stage.height()\n    };\n\n    let scale = this.getImageScaleToStage(\n      stageData.w,\n      stageData.h\n    );\n\n    this.$image.css({\n      width: Math.ceil(img.width * scale) + 'px',\n      height: Math.ceil(img.height * scale) + 'px',\n      left: (stageData.w - Math.ceil(img.width * scale)) / 2 + 'px',\n      top: (stageData.h - Math.ceil(img.height * scale)) / 2 + 'px'\n    });\n\n    // Store image initial data\n    $.extend(this.imageData, {\n      initWidth: img.width * scale,\n      initHeight: img.height * scale,\n      initLeft: (stageData.w - img.width * scale) / 2,\n      initTop: (stageData.h - img.height * scale) / 2,\n      width: img.width * scale,\n      height: img.height * scale,\n      left: (stageData.w - img.width * scale) / 2,\n      top: (stageData.h - img.height * scale) / 2\n    });\n\n    // Set grab cursor\n    setGrabCursor(\n      {\n        w: this.$image.width(),\n        h: this.$image.height()\n      },\n      {\n        w: this.$stage.width(),\n        h: this.$stage.height()\n      },\n      this.$stage,\n      this.isRotated\n    );\n\n    this.$stage.removeClass('stage-ready');\n    this.$image.removeClass('image-ready');\n\n    // loader end\n    this.$photoviewer.find(CLASS_NS + '-loader').remove();\n\n    // Add image init animation\n    if (this.options.initAnimation && !this.options.progressiveLoading) {\n      this.$image.fadeIn();\n    }\n\n  }\n\n  loadImg(imgSrc, fn, err) {\n\n    let loaderHTML = `<div class=\"${NS}-loader\"></div>`;\n\n    // loader start\n    this.$photoviewer.append(loaderHTML);\n\n    // Add class before image loaded\n    this.$stage.addClass('stage-ready');\n    this.$image.addClass('image-ready');\n\n    // Reset image\n    this.$image.removeAttr('style').attr('src', '');\n\n    if (this.options.initAnimation && !this.options.progressiveLoading) {\n      this.$image.hide();\n    }\n\n    this.$image.attr('src', imgSrc);\n\n    preloadImg(imgSrc, (img) => {\n      // Store HTMLImageElement\n      this.img = img;\n\n      // Store original data\n      this.imageData = {\n        originalWidth: img.width,\n        originalHeight: img.height\n      };\n\n      if (this.isMaximized || (this.isOpened && this.options.fixedModalPos)) {\n        this.setImageSize(img);\n      } else {\n        this.setModalSize(img);\n      }\n\n      // callback of image loaded successfully\n      if (fn) {\n        fn.call();\n      }\n\n    }, () => {\n      // loader end\n      this.$photoviewer.find(CLASS_NS + '-loader').remove();\n\n      // callback of image loading failed\n      if (err) {\n        err.call();\n      }\n    });\n\n    if (this.options.title) {\n      this.setImgTitle(imgSrc);\n    }\n\n  }\n\n  setImgTitle(url) {\n\n    let title = this.groupData[this.groupIndex].title\n      ? this.groupData[this.groupIndex].title\n      : getImageNameFromUrl(url);\n\n    this.$title.html(title);\n\n  }\n\n  jump(step) {\n\n    this._triggerHook('beforeChange', this.groupIndex);\n\n    this.groupIndex = this.groupIndex + step;\n\n    this.jumpTo(this.groupIndex);\n\n  }\n\n  jumpTo(index) {\n\n    index = index % this.groupData.length;\n\n    if (index >= 0) {\n      index = index % this.groupData.length;\n    } else if (index < 0) {\n      index = (this.groupData.length + index) % this.groupData.length;\n    }\n\n    this.groupIndex = index;\n\n    this.loadImg(this.groupData[index].src, () => {\n      this._triggerHook('changed', index);\n    }, () => {\n      this._triggerHook('changed', index);\n    });\n\n  }\n\n  wheel(e) {\n\n    e.preventDefault();\n\n    let delta = 1;\n\n    if (e.originalEvent.deltaY) {\n      delta = e.originalEvent.deltaY > 0 ? 1 : -1;\n    } else if (e.originalEvent.wheelDelta) {\n      delta = -e.originalEvent.wheelDelta / 120;\n    } else if (e.originalEvent.detail) {\n      delta = e.originalEvent.detail > 0 ? 1 : -1;\n    }\n\n    // ratio threshold\n    let ratio = -delta * this.options.ratioThreshold;\n\n    // mouse point position relative to stage\n    let pointer = {\n      x: e.originalEvent.clientX - this.$stage.offset().left + $D.scrollLeft(),\n      y: e.originalEvent.clientY - this.$stage.offset().top + $D.scrollTop()\n    };\n\n    this.zoom(ratio, pointer, e);\n\n  }\n\n  zoom(ratio, origin, e) {\n\n    // zoom out ratio & zoom in ratio\n    ratio = ratio < 0 ? (1 / (1 - ratio)) : (1 + ratio);\n\n    // image ratio\n    ratio = this.$image.width() / this.imageData.originalWidth * ratio;\n\n    // Fixed digital error\n    // if (ratio > 0.95 && ratio < 1.05) {\n    //   ratio = 1;\n    // }\n\n    if (ratio > this.options.maxRatio || ratio < this.options.minRatio) {\n      return;\n    }\n\n    this.zoomTo(ratio, origin, e);\n\n  }\n\n  zoomTo(ratio, origin, e) {\n\n    let $image = this.$image,\n      $stage = this.$stage,\n      imgData = {\n        w: this.imageData.width,\n        h: this.imageData.height,\n        x: this.imageData.left,\n        y: this.imageData.top\n      };\n\n    // image stage position\n    // We will use it to calc the relative position of image\n    let stageData = {\n      w: $stage.width(),\n      h: $stage.height(),\n      x: $stage.offset().left,\n      y: $stage.offset().top\n    };\n\n    let newWidth = this.imageData.originalWidth * ratio,\n      newHeight = this.imageData.originalHeight * ratio,\n      // Think about it for a while\n      newLeft = origin.x - (origin.x - imgData.x) / imgData.w * newWidth,\n      newTop = origin.y - (origin.y - imgData.y) / imgData.h * newHeight;\n\n    // δ is the difference between image new width and new height\n    let δ = !this.isRotated ? 0 : (newWidth - newHeight) / 2,\n      imgNewWidth = !this.isRotated ? newWidth : newHeight,\n      imgNewHeight = !this.isRotated ? newHeight : newWidth;\n\n    let offsetX = stageData.w - newWidth,\n      offsetY = stageData.h - newHeight;\n\n    // zoom out & zoom in condition\n    // It's important and it takes me a lot of time to get it\n    // The conditions with image rotate 90 degree drive me crazy alomst!\n    if (imgNewHeight <= stageData.h) {\n      newTop = (stageData.h - newHeight) / 2;\n    } else {\n      newTop = newTop > δ\n        ? δ\n        : (newTop > (offsetY - δ)\n          ? newTop\n          : (offsetY - δ));\n    }\n\n    if (imgNewWidth <= stageData.w) {\n      newLeft = (stageData.w - newWidth) / 2;\n    } else {\n      newLeft = newLeft > -δ\n        ? -δ\n        : (newLeft > (offsetX + δ)\n          ? newLeft\n          : (offsetX + δ));\n    }\n\n    // if the image scale get to the critical point\n    if (Math.abs(this.imageData.initWidth - newWidth) < this.imageData.initWidth * 0.05) {\n      this.setImageSize(this.img);\n    } else {\n      $image.css({\n        width: Math.round(newWidth) + 'px',\n        height: Math.round(newHeight) + 'px',\n        left: Math.round(newLeft) + 'px',\n        top: Math.round(newTop) + 'px'\n      });\n\n      // Set grab cursor\n      setGrabCursor(\n        {\n          w: Math.round(imgNewWidth),\n          h: Math.round(imgNewHeight)\n        },\n        {\n          w: stageData.w,\n          h: stageData.h\n        },\n        this.$stage\n      );\n    }\n\n\n    // Update image initial data\n    $.extend(this.imageData, {\n      width: newWidth,\n      height: newHeight,\n      left: newLeft,\n      top: newTop\n    });\n\n  }\n\n  rotate(angle) {\n\n    this.rotateAngle = this.rotateAngle + angle;\n\n    if ((this.rotateAngle / 90) % 2 === 0) {\n      this.isRotated = false;\n    } else {\n      this.isRotated = true;\n    }\n\n    this.rotateTo(this.rotateAngle);\n\n  }\n\n  rotateTo(angle) {\n\n    this.$image.css({\n      transform: 'rotate(' + angle + 'deg)'\n    });\n\n    this.setImageSize({\n      width: this.imageData.originalWidth,\n      height: this.imageData.originalHeight\n    });\n\n    // Remove grab cursor when rotate\n    this.$stage.removeClass('is-grab');\n\n  }\n\n  resize() {\n\n    let resizeHandler = throttle(() => {\n\n      if (this.isOpened) {\n        if (this.isMaximized) {\n          this.setImageSize({\n            width: this.imageData.originalWidth,\n            height: this.imageData.originalHeight\n          });\n        } else {\n          this.setModalSize({\n            width: this.imageData.originalWidth,\n            height: this.imageData.originalHeight\n          });\n        }\n      }\n\n    }, 500);\n\n    return resizeHandler;\n\n  }\n\n  maximize() {\n\n    if (!this.isMaximized) {\n      // Store modal data before maximize\n      this.modalData = {\n        width: this.$photoviewer.width(),\n        height: this.$photoviewer.height(),\n        left: this.$photoviewer.offset().left,\n        top: this.$photoviewer.offset().top\n      };\n\n      this.$photoviewer.addClass(NS + '-maximize');\n\n      this.$photoviewer.css({\n        width: '100%',\n        height: '100%',\n        left: 0,\n        top: 0\n      });\n\n      this.isMaximized = true;\n\n    } else {\n\n      this.$photoviewer.removeClass(NS + '-maximize');\n\n      this.$photoviewer.css({\n        width: this.modalData.width\n          ? this.modalData.width\n          : this.options.modalWidth,\n        height: this.modalData.height\n          ? this.modalData.height\n          : this.options.modalHeight,\n        left: this.modalData.left\n          ? this.modalData.left\n          : ($W.width() - this.options.modalWidth) / 2 + $D.scrollLeft(),\n        top: this.modalData.top\n          ? this.modalData.top\n          : ($W.height() - this.options.modalHeight) / 2 + $D.scrollTop()\n      });\n\n      this.isMaximized = false;\n    }\n\n    this.setImageSize({\n      width: this.imageData.originalWidth,\n      height: this.imageData.originalHeight\n    });\n\n  }\n\n  fullscreen() {\n\n    requestFullscreen(this.$photoviewer[0]);\n\n  }\n\n  keydown(e) {\n\n    if (!this.options.keyboard) {\n      return false;\n    }\n\n    let keyCode = e.keyCode || e.which || e.charCode,\n      ctrlKey = e.ctrlKey || e.metaKey,\n      altKey = e.altKey || e.metaKey;\n\n    switch (keyCode) {\n      // ←\n      case 37:\n        this.jump(-1);\n        break;\n      // →\n      case 39:\n        this.jump(1);\n        break;\n      // +\n      case 187:\n        this.zoom(\n          this.options.ratioThreshold * 3,\n          { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n          e\n        );\n        break;\n      // -\n      case 189:\n        this.zoom(\n          -this.options.ratioThreshold * 3,\n          { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n          e\n        );\n        break;\n      // + Firefox\n      case 61:\n        this.zoom(\n          this.options.ratioThreshold * 3,\n          { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n          e\n        );\n        break;\n      // - Firefox\n      case 173:\n        this.zoom(\n          -this.options.ratioThreshold * 3,\n          { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n          e\n        );\n        break;\n      // ctrl + alt + 0\n      case 48:\n        if (ctrlKey && altKey) {\n          this.zoomTo(\n            1,\n            { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n            e\n          );\n        }\n        break;\n      // ctrl + ,\n      case 188:\n        if (ctrlKey) {\n          this.rotate(-90);\n        }\n        break;\n      // ctrl + .\n      case 190:\n        if (ctrlKey) {\n          this.rotate(90);\n        }\n        break;\n      default:\n    }\n\n  }\n\n  addEvents() {\n\n    this.$close.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, (e) => {\n      this.close();\n    });\n\n    this.$stage.off(WHEEL_EVENT + EVENT_NS).on(WHEEL_EVENT + EVENT_NS, (e) => {\n      this.wheel(e);\n    });\n\n    this.$zoomIn.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, (e) => {\n      this.zoom(\n        this.options.ratioThreshold * 3,\n        { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n        e\n      );\n    });\n\n    this.$zoomOut.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, (e) => {\n      this.zoom(\n        -this.options.ratioThreshold * 3,\n        { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n        e\n      );\n    });\n\n    this.$actualSize.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, (e) => {\n      this.zoomTo(\n        1,\n        { x: this.$stage.width() / 2, y: this.$stage.height() / 2 },\n        e\n      );\n    });\n\n    this.$prev.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.jump(-1);\n    });\n\n    this.$fullscreen.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.fullscreen();\n    });\n\n    this.$next.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.jump(1);\n    });\n\n    this.$rotateLeft.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.rotate(-90);\n    });\n\n    this.$rotateRight.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.rotate(90);\n    });\n\n    this.$maximize.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, () => {\n      this.maximize();\n    });\n\n    $D.off(KEYDOWN_EVENT + EVENT_NS).on(KEYDOWN_EVENT + EVENT_NS, (e) => {\n      this.keydown(e);\n    });\n\n    $W.on(RESIZE_EVENT + EVENT_NS, this.resize());\n\n  }\n\n  _triggerHook(e, data) {\n    if (this.options.callbacks[e]) {\n      this.options.callbacks[e].apply(this, $.isArray(data) ? data : [data]);\n    }\n  }\n\n\n}\n\n/**\n * Add methods to PhotoViewer\n */\n$.extend(PhotoViewer.prototype, draggable, movable, resizable);\n\n/**\n * Add PhotoViewer to globle\n */\nwindow.PhotoViewer = PhotoViewer;\n\n/**\n * jQuery plugin\n */\n\nlet jqEl = null,\n  getImgGroup = function (list, groupName) {\n\n    let items = [];\n\n    $(list).each(function () {\n\n      let src = getImgSrc(this);\n\n      items.push({\n        src: src,\n        title: $(this).attr('data-title'),\n        groupName: groupName\n      });\n\n    });\n\n    return items;\n\n  }\n\n$.fn.photoviewer = function (options) {\n\n  jqEl = $(this);\n\n  options = options ? options : {};\n\n  // Convert a numeric string into a number\n  for (let key in options) {\n    if (typeof (options[key]) === 'string' && !isNaN(options[key])) {\n      options[key] = parseFloat(options[key])\n    }\n  }\n\n  // Get init event, 'click' or 'dblclick'\n  let opts = $.extend(true, {}, DEFAULTS, options);\n\n  // We should get zIndex of options before plugin's init.\n  PUBLIC_VARS['zIndex'] = opts.zIndex;\n\n  if (typeof options === 'string') {\n\n    // $(this).data('photoviewer')[options]();\n\n  } else {\n\n    jqEl.off(CLICK_EVENT + EVENT_NS).on(CLICK_EVENT + EVENT_NS, function (e) {\n\n      e.preventDefault();\n      // This will stop triggering data-api event\n      e.stopPropagation();\n\n      // Get image group\n      let items = [],\n        currentGroupName = $(this).attr('data-group'),\n        groupList = $D.find('[data-group=\"' + currentGroupName + '\"]');\n\n      if (currentGroupName !== undefined) {\n        items = getImgGroup(groupList, currentGroupName);\n        options['index'] = $(this).index('[data-group=\"' + currentGroupName + '\"]');\n      } else {\n        items = getImgGroup(jqEl.not('[data-group]'));\n        options['index'] = $(this).index();\n      }\n\n      $(this).data(NS, new PhotoViewer(items, options, this));\n\n    });\n\n  }\n\n  return jqEl;\n\n};\n\n/**\n * PhotoViewer DATA-API\n */\n$D.on(CLICK_EVENT + EVENT_NS, '[data-' + NS + ']', function (e) {\n\n  jqEl = $('[data-' + NS + ']');\n\n  e.preventDefault();\n\n  // Get image group\n  let items = [],\n    currentGroupName = $(this).attr('data-group'),\n    groupList = $D.find('[data-group=\"' + currentGroupName + '\"]');\n\n  if (currentGroupName !== undefined) {\n    items = getImgGroup(groupList, currentGroupName);\n    DEFAULTS['index'] = $(this).index('[data-group=\"' + currentGroupName + '\"]');\n  } else {\n    items = getImgGroup(jqEl.not('[data-group]'));\n    DEFAULTS['index'] = $(this).index();\n  }\n\n  $(this).data(NS, new PhotoViewer(items, DEFAULTS, this));\n\n});\n\nexport default PhotoViewer;\n"],"names":["$","noop","getImgSrc","el","src","attr","throttle","fn","delay","timer","context","args","arguments","setTimeout","apply","preloadImg","success","error","img","Image","onload","onerror","requestFullscreen","element","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","getImageNameFromUrl","url","reg","txt","replace","getNumFromCSSValue","value","arr","match","num","parseFloat","hasScrollbar","document","body","scrollHeight","window","innerHeight","documentElement","clientHeight","getScrollbarWidth","scrollDiv","createElement","style","cssText","appendChild","scrollbarWidth","offsetWidth","clientWidth","removeChild","setGrabCursor","imageData","stageData","stage","isRotated","imageWidth","w","h","imageHeight","addClass","removeClass","supportTouch","DocumentTouch","$W","$D","CLICK_EVENT","RESIZE_EVENT","KEYDOWN_EVENT","WHEEL_EVENT","TOUCH_START_EVENT","TOUCH_MOVE_EVENT","TOUCH_END_EVENT","NS","CLASS_NS","EVENT_NS","PUBLIC_VARS","defaults","zIndex","modal","dragHandle","dragCancel","isDragging","startX","startY","left","top","dragStart","e","event","options","multiInstances","css","elemCancel","target","closest","length","type","originalEvent","targetTouches","pageX","clientX","pageY","clientY","offset","on","dragMove","dragEnd","preventDefault","isMaximized","endX","endY","relativeX","relativeY","off","ELEMS_WITH_GRABBING_CURSOR","image","widthDiff","heightDiff","δ","width","height","stageWidth","stageHeight","position","hasClass","newLeft","newTop","extend","ELEMS_WITH_RESIZE_CURSOR","minWidth","minHeight","resizableHandleE","resizableHandleW","resizableHandleS","resizableHandleN","resizableHandleSE","resizableHandleSW","resizableHandleNE","resizableHandleNW","resizableHandles","append","modalData","imgWidth","imgHeight","direction","getModalOpts","dir","offsetX","offsetY","modalLeft","l","modalTop","t","opts","Math","max","getImageOpts","widthDiff2","heightDiff2","imgLeft","imgTop","imgLeft2","imgTop2","modalOpts","imageOpts","isDoResize","scale","getImageScaleToStage","each","handle","PhotoViewer","items","DEFAULTS","isArray","footToolbar","headToolbar","$el","isOpened","rotateAngle","init","groupData","groupIndex","imgSrc","open","loadImg","draggable","$photoviewer","movable","$stage","$image","resizable","modalWidth","modalHeight","_creatBtns","toolbar","btns","btnsStr","index","item","_creatTitle","title","_creatDOM","btnsTpl","i18n","minimize","icons","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight","photoviewerHTML","build","$header","find","$headToolbar","$footer","$footToolbar","$title","$close","$maximize","$minimize","$zoomIn","$zoomOut","$actualSize","$fullscreen","$rotateLeft","$rotateRight","$prev","$next","eq","remove","fixedContent","_triggerHook","addEvents","setModalPos","zeroModal","winWidth","winHeight","scrollLeft","scrollTop","initMaximized","setModalSize","stageCSS","right","borderLeft","borderRight","bottom","borderTop","borderBottom","gapThreshold","min","fixedModalSize","round","modalCSSObj","initAnimation","animate","setImageSize","ceil","progressiveLoading","fadeIn","err","loaderHTML","removeAttr","hide","fixedModalPos","call","setImgTitle","html","jump","step","jumpTo","wheel","delta","deltaY","wheelDelta","detail","ratio","ratioThreshold","pointer","zoom","origin","originalWidth","maxRatio","minRatio","zoomTo","imgData","newWidth","newHeight","originalHeight","x","y","imgNewWidth","imgNewHeight","abs","initWidth","rotate","angle","rotateTo","resize","resizeHandler","keydown","keyboard","keyCode","which","charCode","ctrlKey","metaKey","altKey","data","callbacks","prototype","jqEl","getImgGroup","list","groupName","push","photoviewer","key","isNaN","stopPropagation","currentGroupName","groupList","undefined","not"],"mappings":"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"}